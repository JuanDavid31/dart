/*
 * Copyright (c) 2011-present Sonatype, Inc. All rights reserved.
 * Includes the third-party code listed at http://links.sonatype.com/products/clm/attributions.
 * "Sonatype" is a trademark of Sonatype, Inc.
 */
/* eslint react/prop-types: 0 */
import React from 'react';
import { NxOverflowTooltip } from '@sonatype/react-shared-components';
import RenderDetail from './RenderDetail';
import SeverityScoreDisplay from './SeverityScoreDisplay';
import SubDescriptionList from './SubDescriptionList';

const CVSSDetail = function CVSSDetail({ severity, customData }) {
  if (
    (severity || customData) &&
    (severity?.source || severity?.vector || customData?.cvssVector || customData?.cvssSeverity)
  ) {
    const customSeverity = customData?.cvssSeverity
      ? { source: 'severity', score: customData.cvssSeverity, isCustom: true }
      : null;
    return (
      <RenderDetail title="CVSS Details">
        <SubDescriptionList>
          {customSeverity && <SeverityScoreDisplay severityScore={customSeverity} />}
          {customData?.cvssVector && (
            <NxOverflowTooltip title={customData.cvssVector}>
              <SubDescriptionList.Container>
                <SubDescriptionList.Term>Vector String</SubDescriptionList.Term>
                <SubDescriptionList.Desc>
                  {customData.cvssVector} <b>(Custom)</b>
                </SubDescriptionList.Desc>
              </SubDescriptionList.Container>
            </NxOverflowTooltip>
          )}
          {severity?.source && <SeverityScoreDisplay severityScore={severity} />}
          {severity?.vector && (
            <SubDescriptionList.Container>
              <SubDescriptionList.Term>CVSS Vector</SubDescriptionList.Term>
              <SubDescriptionList.Desc>{severity.vector}</SubDescriptionList.Desc>
            </SubDescriptionList.Container>
          )}
        </SubDescriptionList>
      </RenderDetail>
    );
  }
  return null;
};

export default CVSSDetail;
