/*
 * Copyright (c) 2011-present Sonatype, Inc. All rights reserved.
 * Includes the third-party code listed at http://links.sonatype.com/products/clm/attributions.
 * "Sonatype" is a trademark of Sonatype, Inc.
 */
/* eslint react/prop-types: 0 */
import React from 'react';
import DetailLink from './DetailLink';
import RenderDetail from './RenderDetail';
import SubDescriptionList from './SubDescriptionList';

const WeaknessDetail = function WeaknessDetail({ weakness, customCwe }) {
  if (weakness || customCwe) {
    const cweLinks = weakness
      ? weakness.cweIds.map((cweId) => (
          <SubDescriptionList.Desc key={cweId.id}>
            <DetailLink href={cweId.uri}>{cweId.id}</DetailLink>
          </SubDescriptionList.Desc>
        ))
      : null;
    const customCweLinks = customCwe
      ? customCwe.split(',').map((cweId) => (
          <SubDescriptionList.Desc key={cweId}>
            <DetailLink href={`https://cwe.mitre.org/data/definitions/${cweId}.html`}>{cweId}</DetailLink>
          </SubDescriptionList.Desc>
        ))
      : null;

    return cweLinks?.length || customCwe ? (
      <RenderDetail title="Weakness" isShort isRestricted={customCweLinks?.length >= 2}>
        <SubDescriptionList>
          {customCweLinks?.length && (
            <SubDescriptionList.Container>
              <SubDescriptionList.Term>CWE</SubDescriptionList.Term>
              {customCweLinks} <b>(Custom)</b>
            </SubDescriptionList.Container>
          )}
          {cweLinks?.length && (
            <SubDescriptionList.Container>
              <SubDescriptionList.Term>{weakness.cweSource} CWE</SubDescriptionList.Term>
              {cweLinks}
            </SubDescriptionList.Container>
          )}
        </SubDescriptionList>
      </RenderDetail>
    ) : null;
  } else {
    return null;
  }
};

export default WeaknessDetail;
