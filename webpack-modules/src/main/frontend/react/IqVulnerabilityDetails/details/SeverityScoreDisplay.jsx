/*
 * Copyright (c) 2011-present Sonatype, Inc. All rights reserved.
 * Includes the third-party code listed at http://links.sonatype.com/products/clm/attributions.
 * "Sonatype" is a trademark of Sonatype, Inc.
 */
/* eslint react/prop-types: 0 */
import React from 'react';
import SubDescriptionList from './SubDescriptionList';

const SeverityScoreDisplay = function SeverityScoreDisplay({ severityScore }) {
  const severitySourceDescriptionMap = {
    cve_cvss_4: 'CVE CVSS 4',
    cve_cvss_31: 'CVE CVSS 3.1',
    cve_cvss_3: 'CVE CVSS 3',
    cve_cvss_2: 'CVE CVSS 2.0',
    sonatype_cvss_4: 'Sonatype CVSS 4',
    sonatype_cvss_31: 'Sonatype CVSS 3.1',
    sonatype_cvss_3: 'Sonatype CVSS 3',
    sonatype_cvss_2: 'Sonatype CVSS 2.0',
    severity: 'Severity',
  };
  const { source: sourceProp, sourceLabel: sourceLabelProp, score, isCustom } = severityScore,
    source = sourceProp ? severitySourceDescriptionMap[sourceProp] : 'Unknown',
    sourceLabel = sourceLabelProp ? sourceLabelProp : source,
    termClass = sourceProp ? undefined : 'iq-vulnerability-details__sub-description-term--unknown',
    severity = score.toFixed(1);

  return (
    <SubDescriptionList.Container>
      <SubDescriptionList.Term className={termClass}>{sourceLabel}</SubDescriptionList.Term>
      <SubDescriptionList.Desc>
        {severity} {isCustom ? <b>(Custom)</b> : null}
      </SubDescriptionList.Desc>
    </SubDescriptionList.Container>
  );
};

export default SeverityScoreDisplay;
