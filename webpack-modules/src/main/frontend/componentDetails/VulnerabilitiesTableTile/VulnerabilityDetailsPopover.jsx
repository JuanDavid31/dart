/*
 * Copyright (c) 2011-present Sonatype, Inc. All rights reserved.
 * Includes the third-party code listed at http://links.sonatype.com/products/clm/attributions.
 * "Sonatype" is a trademark of Sonatype, Inc.
 */
import React from 'react';
import PropTypes from 'prop-types';
import IqVulnerabilityDetails from 'MainRoot/react/IqVulnerabilityDetails/IqVulnerabilityDetails';
import IqPopover from '../../react/IqPopover/IqPopover';
import VulnerabilityDetails from './VulnerabilityDetails';
import SecurityVulnerabilityOverrideFormContainer from './SecurityVulnerabilityOverrideFormContainer';

export default function VulnerabilityDetailsPopover({
  showVulnerabilityDetailPopover,
  toggleVulnerabilityPopoverWithEffects,
  componentName,
  componentIdentifier,
  ownerType,
  ownerId,
  hasEditIqPermission,
  componentHash,

  tabId,
  repositoryId,
  matchState,
  pathname,
  isFirewall,

  ...vulnerabilityDetailsProps
}) {
  const onClose = () => toggleVulnerabilityPopoverWithEffects(null);

  return !showVulnerabilityDetailPopover ? null : (
    <IqPopover size="large" onClose={onClose} id="component-details-vulnerability-details-popover">
      <IqPopover.Header
        id="vulnerability-detail-header"
        className="vulnerability-detail-header"
        buttonId="vulnerability-close-btn"
        onClose={onClose}
        headerTitle="Vulnerability Details"
      />
      <SecurityVulnerabilityOverrideFormContainer />
      <VulnerabilityDetails
        {...vulnerabilityDetailsProps}
        componentName={componentName}
        componentIdentifier={componentIdentifier}
        ownerType={ownerType}
        ownerId={ownerId}
        hasEditIqPermission={hasEditIqPermission}
        componentHash={componentHash}
        tabId={tabId}
        repositoryId={repositoryId}
        matchState={matchState}
        pathname={pathname}
        isFirewall={isFirewall}
      />
    </IqPopover>
  );
}

VulnerabilityDetailsPopover.propTypes = {
  showVulnerabilityDetailPopover: PropTypes.bool.isRequired,
  toggleVulnerabilityPopoverWithEffects: PropTypes.func.isRequired,
  loadVulnerabilityDetails: PropTypes.func.isRequired,
  loading: PropTypes.bool.isRequired,
  error: PropTypes.string,
  details: PropTypes.oneOfType([IqVulnerabilityDetails.propTypes.vulnerabilityDetails, PropTypes.oneOf([null])]),
  componentName: PropTypes.string,
  componentIdentifier: IqVulnerabilityDetails.propTypes.componentIdentifier,
  ownerType: IqVulnerabilityDetails.propTypes.ownerType,
  ownerId: IqVulnerabilityDetails.propTypes.ownerId,
  componentHash: PropTypes.string,
  hasEditIqPermission: PropTypes.bool,
  tabId: PropTypes.string,
  repositoryId: PropTypes.string,
  matchState: PropTypes.string,
  pathname: PropTypes.string,
  isFirewall: PropTypes.bool,
};
