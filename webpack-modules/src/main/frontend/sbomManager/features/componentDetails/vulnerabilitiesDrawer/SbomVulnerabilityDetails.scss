/**
 * Copyright (c) 2011-present Sonatype, Inc. All rights reserved.
 * Includes the third-party code listed at http://links.sonatype.com/products/clm/attributions.
 * "Sonatype" is a trademark of Sonatype, Inc.
 */

@use '~@sonatype/react-shared-components/scss-shared/nx-container-helpers';
@use '~@sonatype/react-shared-components/scss-shared/nx-text-helpers';

$-inline-margin: var(--nx-spacing-base);

.sbom-vulnerability-details {
  > :last-child {
    margin-bottom: 0;
  }

  .nx-grid-col {
    flex: 0 1 auto;

    &:first-child {
      // don't truncate left-side content
      min-width: min-content;
    }
  }

  .nx-read-only .iq-left-details {
    max-width: 260px;
  }

  .iq-left-details-cwe .sbom-vulnerability-details__sub-description-container {
    white-space: normal;
  }

  .nx-read-only__data,
  .nx-read-only__label {
    max-width: none;
  }

  .nx-alert__content .nx-h3 {
    margin-bottom: var(--nx-spacing-2x);
    color: var(--nx-swatch-blue-40);
    font-weight: 600;
  }

  .nx-alert__content .nx-h3 + .nx-p {
    margin-top: var(--nx-spacing-2x);
  }
}

.sbom-vulnerability-details__sub-description-list {
  @include nx-container-helpers.container-vertical;

  margin: 0;
}

.sbom-vulnerability-details__sub-description-container {
  @include nx-text-helpers.truncate-ellipsis;
  margin-bottom: var(--nx-spacing-2x);
}

.sbom-vulnerability-details__sub-description-term {
  display: inline;
  max-width: var(--nx-width-text-wrapping);

  &::after {
    content: ':';
  }
}

.sbom-vulnerability-details__sub-description-term--unknown {
  overflow: hidden;
  width: 0;
}

.sbom-vulnerability-details__sub-description-desc {
  display: inline;
  margin-left: var(--nx-spacing-2x);
  max-width: var(--nx-width-text-wrapping);

  + .sbom-vulnerability-details__sub-description-desc {
    margin: 0;

    &::before {
      content: ', ';
    }
  }
}

.sbom-vulnerability-details__root-cause-path + .sbom-vulnerability-details__root-cause-path {
  &::before {
    @include nx-text-helpers.bold;

    content: '<=';
    margin: 0 $-inline-margin 0 $-inline-margin;
  }
}

.sbom-vulnerability-details__root-cause-version-range {
  &::before {
    content: ':';
    margin: 0 $-inline-margin 0 $-inline-margin;
  }
}

.sbom-vulnerability-details__warning {
  @include nx-container-helpers.container-horizontal;
  color: var(--nx-swatch-red-45);

  strong {
    @include nx-text-helpers.semi-bold;
  }
}

.sbom-vulnerability-details__html-detail {
  display: contents;

  p {
    @extend %nx-p;
  }

  code {
    @extend %nx-code;
  }

  pre {
    @extend %nx-pre;
  }

  blockquote {
    @extend %nx-blockquote;
  }
}

.sbom-vulnerability-details__render-detail__info-icon-black {
  color: black;
}

.sbom-vulnerability-details label.nx-tag:first-child {
  margin-left: var(--nx-spacing-4x);
}

.sbom-vulnerability-details svg.fa-cube {
  margin-left: 0;
  color: var(--nx-swatch-grey-05);
}

.sbom-vulnerability-details > span.nx-h4 {
  color: var(--nx-swatch-grey-05);
}

.sbom-vulnerability-details > h2.nx-h2 {
  margin-bottom: 0;
  display: flex;
  justify-content: space-between;
}

.sbom-vulnerability-details__customize-vulnerability-button > a.nx-btn {
  margin: 0;
}

.sbom-vulnerability-details__h2-identifier-labels-button-container-button-present {
  margin-top: 40px;
}

.sbom-vulnerability-details__no-bottom-margin {
  margin-bottom: 0;
}

.sbom-vulnerability-details__h2-no-customize-button {
  margin-top: 0;
}

.sbom-vulnerability-details__vulnerability-id-and-conditional-labels .sbom-vulnerability-details__vulnerability-id {
  margin-right: 32px;
}
